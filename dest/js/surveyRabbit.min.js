var RADIO="Radio",CHECKBOX="CheckBox",counter=0,SurveyRabbitView=function(a){return this.model=a,this},_renderPreview=function(a){var b="<fieldset><legend>"+a.question+"</legend>",c=[];for(i=0;i<a.answer.length;i++)c+='<div class="'+a.type+'"><label><input type="'+a.type+'">'+a.answer[i]+"</label></div>";return b+c+"</fieldset>"};SurveyRabbitView.prototype.renderWidgets=function(){var a=[];$.each(this.model.widgets,function(b){lowerCaseKey=b.toLowerCase(),a+="<div class="+lowerCaseKey+'><label><input type="'+lowerCaseKey+'"id="'+lowerCaseKey+'widget">'+b+"</label></div>"}),$("#sr-widgetContainer").append(a)},SurveyRabbitView.prototype.renderSurvey=function(a){var b="radio"===a?RADIO:CHECKBOX;allSurveyView='<div class="sr-questionWrapper"><div class="col-sm-offset-1 col-sm-10"><div class="'+a+'"><label><input type="'+a+'" data-index="'+counter+'" id="'+a+counter+'">'+b+'</label><button type="button" class="close" data-index="'+counter+'" id="close'+counter+'"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div><div class="col-sm-offset-1 col-sm-10"><input type="text" class="form-control question" data-index="'+counter+'" name="question" id="question'+counter+'"></div><div class="col-sm-offset-1 col-sm-10"><input type="text" class="form-control answer" data-index="'+counter+'" name="answer" id="answer'+counter+'"></div></div>',$("#sr-surveyQuestionContainer").append(allSurveyView),counter++},SurveyRabbitView.prototype.removeSurveyQuestion=function(a){a.parentsUntil("#sr-surveyQuestionContainer").remove()},SurveyRabbitView.prototype.renderPreview=function(){var a="<h2>"+this.model.surveyTitle+"</h2>",b=[];$("h1").text("Preview"),$.each(this.model.allSurveyQuestions,function(a,c){b+=_renderPreview(c)}),$(".form-horizontal").children().remove(),$(".form-horizontal").append(a+b)};var SurveyRabbitController=function(){return this.model=new SurveyRabbitModel,this.view=new SurveyRabbitView(this.model),this};SurveyRabbitController.prototype.loadView=function(){this.view.renderWidgets()},SurveyRabbitController.prototype.bindEvents=function(){var a,b,c=this,d="",e="";$("#sr-widgetContainer").delegate("input","click",function(a){$(this).prop("checked",!1),c.view.renderSurvey(a.target.type)}),$("#sr-title input").change(function(){c.model.updateTitle($(this).val())}),$("#sr-surveyQuestionContainer").delegate("button","click",function(){var a=$(this).data("index");c.view.removeSurveyQuestion($(this)),c.model.removeModelObject(a)}),$("#sr-surveyQuestionContainer").delegate("input","change",function(){$(this).parentsUntil("#sr-surveyQuestionContainer").find("input").each(function(){"radio"===$(this).attr("type")||"checkbox"===$(this).attr("type")?a=$(this).attr("type"):"question"===$(this).attr("name")?d=$(this).val():"answer"===$(this).attr("name")&&(e=$(this).val()),b=$(this).data("index")}),""!==d&&""!==e&&c.model.updateModel(a,d,e,b)}),$("#sr-previewButton").click(function(a){a.preventDefault(),c.view.renderPreview()})};var SurveyRabbitModel=function(){return this.surveyTitle="",this.allSurveyQuestions=[],this.widgets={Radio:0,Checkbox:1},this},_updateAllSurvey=function(a,b,c){return c.allSurveyQuestions[b]=a,c};SurveyRabbitModel.prototype.updateTitle=function(a){return this.surveyTitle=a,this},SurveyRabbitModel.prototype.updateModel=function(a,b,c,d){var e=this,f={};return f={type:a,question:b,answer:c.split(","),index:d},_updateAllSurvey(f,d,e),f},SurveyRabbitModel.prototype.removeModelObject=function(a){return this.allSurveyQuestions.splice(a,1),this};